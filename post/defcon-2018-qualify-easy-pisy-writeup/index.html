<html>
      <head>
        <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1,initial-scale=1,user-scalable=no" />
        <meta charset="utf-8">
        <meta name="referrer" content="never">
        <title>Defcon 2018 Qualify: Easy Pisy writeup | PandaTea</title>
        <link rel="stylesheet" href="https://cdn.staticfile.org/KaTeX/0.11.1/katex.min.css">
        <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
        <link rel="stylesheet" href="https://pandatea.life/styles/main.css">
          <script src="https://pandatea.life/media/scripts/mdui.min.js"></script>
        <link rel="stylesheet" href="https://at.alicdn.com/t/font_1306644_jwtuc2zzbrd.css">
        <link href="https://fonts.googleapis.com/css?family=Dancing+Script|Ma+Shan+Zheng&display=swap" rel="stylesheet">
        <script src="https://cdn.bootcss.com/highlight.js/9.15.10/highlight.min.js"></script>
        <script src="https://pandatea.life/media/scripts/script.js"></script>
        <script >hljs.initHighlightingOnLoad();</script>
        

<script async src="https://www.googletagmanager.com/gtag/js?id=G-F7D1S6XPLZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-F7D1S6XPLZ');
</script>

    </head>
    <body class="mdui-theme-primary-purple mdui-theme-accent-purple">
        <header class="index-img mdui-m-b-3"  style="background-image: url(https://pandatea.life/post-images/defcon-2018-qualify-easy-pisy-writeup.png);" >
                          <button class="mdui-btn  mdui-btn-icon mdui-btn-dense mdui-color-theme-500 mdui-ripple yinying mdui-m-t-1 mdui-m-l-1" mdui-menu="{target: '#demo-attr-cascade'}"><i class="mdui-icon material-icons">&#xe5d2;</i></button>
                <ul class="mdui-menu" id="demo-attr-cascade">
                
                        <li class="mdui-menu-item">
                          <a href="/" class="mdui-ripple">首页</a>
                        </li>
                
                        <li class="mdui-menu-item">
                          <a href="/archives" class="mdui-ripple">归档</a>
                        </li>
                
                        <li class="mdui-menu-item">
                          <a href="/tags" class="mdui-ripple">标签</a>
                        </li>
                
                        <li class="mdui-menu-item">
                          <a href="/post/about" class="mdui-ripple">关于</a>
                        </li>
                
                      </ul>

        </header>
        <div class="mdui-container post">
                <div class="mdui-row">
                        <div class="mdui-col-md-8 mdui-col-offset-md-2 ">
                         <article class="mdui-shadow-10 mdui-p-a-2 post-list">
                           <div class="mdui-typo-display-1 mdui-m-b-3">Defcon 2018 Qualify: Easy Pisy writeup</div>
                           <a  class="index-list-biaoqian ">2021-05-29</a>
                           <div class="mdui-typo mdui-m-t-3 post-neirong"><p><ul class="markdownIt-TOC">
<li><a href="#defcon-2018-qualify-easy-pisy">Defcon 2018 Qualify: Easy Pisy</a>
<ul>
<li><a href="#1-source-code">1. Source Code</a></li>
<li><a href="#2-writeup">2. Writeup</a></li>
<li><a href="#3-info">3. Info</a></li>
<li><a href="#4-analysis-of-author">4. Analysis of Author</a>
<ul>
<li><a href="#41-janmasarik">4.1 janmasarik</a></li>
<li><a href="#42-nneonneo-robert-xiao">4.2 nneonneo (Robert Xiao)</a></li>
<li><a href="#43-marc-stevens">4.3 Marc Stevens</a></li>
<li><a href="#44-elie-bursztein-google">4.4 Elie Bursztein (Google)</a></li>
</ul>
</li>
<li><a href="#5-%E8%AF%AD%E8%A8%80%E4%B8%AD%E7%9A%84%E7%AD%BE%E5%90%8D%E5%87%BD%E6%95%B0">5. 语言中的签名函数</a>
<ul>
<li><a href="#51-php">5.1 php</a>
<ul>
<li><a href="#511-standards-library">5.1.1 standards library</a>
<ul>
<li><a href="#5111-hash">5.1.1.1 Hash</a></li>
<li><a href="#5112-%E5%AF%86%E7%A0%81%E6%95%A3%E5%88%97%E7%AE%97%E6%B3%95%E5%87%BD%E6%95%B0">5.1.1.2 密码散列算法函数</a></li>
</ul>
</li>
<li><a href="#512-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93">5.1.2 第三方库</a>
<ul>
<li><a href="#5121-openssl">5.1.2.1 OpenSSL</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#52-python">5.2 python</a>
<ul>
<li><a href="#521-standards-library">5.2.1 standards library</a>
<ul>
<li><a href="#5211-hashlib">5.2.1.1 hashlib</a></li>
<li><a href="#5212-hmac">5.2.1.2 hmac</a></li>
</ul>
</li>
<li><a href="#522-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93">5.2.2 第三方库</a>
<ul>
<li><a href="#5221-cryptography">5.2.2.1 cryptography</a></li>
<li><a href="#5222-voidspace">5.2.2.2 VoidSpace</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#53-go">5.3 go</a>
<ul>
<li><a href="#531-standards-library">5.3.1 standards library</a>
<ul>
<li><a href="#5311-crypto">5.3.1.1 crypto</a></li>
<li><a href="#5312-crypto%E5%8C%85%E4%B8%8B%E5%85%B6%E4%BB%96%E5%8A%A0%E5%AF%86%E5%8C%85">5.3.1.2 crypto包下其他加密包</a></li>
</ul>
</li>
<li><a href="#532-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93">5.3.2 第三方库</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#6-%E5%AF%86%E7%A0%81%E5%AD%A6%E7%9F%A5%E8%AF%86%E7%82%B9">6. 密码学知识点</a>
<ul>
<li><a href="#md5">md5</a></li>
<li><a href="#%E6%85%A2%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0">慢哈希函数</a></li>
<li><a href="#argon2">ARGON2</a></li>
<li><a href="#rc2_40">RC2_40</a></li>
<li><a href="#smime">SMIME</a></li>
<li><a href="#s%E7%9B%92">S盒</a></li>
<li><a href="#rc4">RC4</a></li>
<li><a href="#sha1">SHA1</a></li>
<li><a href="#pkcs7_detached">PKCS7_DETACHED</a></li>
<li><a href="#openssl_pkcs1_padding">OPENSSL_PKCS1_PADDING</a></li>
<li><a href="#ecdsa">ecdsa</a></li>
<li><a href="#subtle">subtle</a></li>
</ul>
</li>
<li><a href="#7-bucket-%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF">7. Bucket 配置错误</a></li>
<li><a href="#8-non-interactive-cryptographic-timestamping-based-on-verifiable-delay-functions">8. 《Non-interactive cryptographic timestamping based on verifiable delay functions》</a></li>
<li><a href="#9-sha1collisiondetection">9. sha1collisiondetection</a></li>
<li><a href="#10-on-immutability-of-blockchains">10. 《On immutability of blockchains》</a></li>
<li><a href="#11-collect-crypto-2021-paper">11. collect Crypto 2021 Paper</a></li>
<li><a href="#12-a-hackers-guide-to-reducing-side-channel-attack-surfaces-using-deep-learning">12. A Hacker’s guide to reducing side-channel attack surfaces using deep-learning</a></li>
<li><a href="#13-%E5%9F%BA%E4%BA%8E%E6%97%81%E8%B7%AF%E6%94%BB%E5%87%BB%E7%9A%84aes%E7%AE%97%E6%B3%95%E4%B8%AD%E9%97%B4%E5%8F%98%E9%87%8F%E8%84%86%E5%BC%B1%E7%82%B9">13. 基于旁路攻击的AES算法中间变量脆弱点</a></li>
</ul>
</li>
<li><a href="#%E6%80%BB%E7%BB%93">总结</a></li>
</ul>
</p>
<h1 id="defcon-2018-qualify-easy-pisy">Defcon 2018 Qualify: Easy Pisy</h1>
<h2 id="1-source-code">1. Source Code</h2>
<p>题目给了俩PHP：</p>
<ul>
<li><code>execute.php</code></li>
</ul>
<pre><code class="language-php">&lt;?php

include 'common.php';

if ($_SERVER['REQUEST_METHOD'] === 'GET') {
  print highlight_string(file_get_contents(&quot;execute.php&quot;), TRUE);
  exit(0);
}

$keys = get_keys();
$privkey = $keys[0];
$pubkey = $keys[1];

$file_info = $_FILES['userfile'];
check_uploaded_file($file_info);

$data = file_get_contents($file_info['tmp_name']);
$signature = hex2bin($_POST['signature']);
if (openssl_verify($data, $signature, $pubkey)) {
  print 'Signature is OK.&lt;br/&gt;';
} else {
  die('Bad signature.');
}

$text = pdf_to_text($file_info['tmp_name']);
print &quot;Text: \&quot;$text\&quot;&lt;br/&gt;&quot;;

$execute_query = &quot;EXECUTE &quot;;
$echo_query = &quot;ECHO &quot;;
if (substr($text, 0, strlen($execute_query)) === $execute_query) {
  $payload = substr($text, strlen($execute_query));
  print &quot;About to execute: \&quot;$payload\&quot;.&lt;br/&gt;&quot;;
  $out = shell_exec($payload);
  print &quot;Output: $out&quot;;
} else if (substr($text, 0, strlen($echo_query)) === $echo_query) {
  $payload = substr($text, strlen($echo_query));
  print &quot;About to echo: \&quot;$payload\&quot;.&lt;br/&gt;&quot;;
  echo $payload;
} else {
  print &quot;I can't recognize the command type. Go away.&lt;br/&gt;&quot;;
}

?&gt;
</code></pre>
<ul>
<li><code>shellme.php</code></li>
</ul>
<pre><code class="language-php">&lt;?php

include 'common.php';

if ($_SERVER['REQUEST_METHOD'] === 'GET') {
  print highlight_string(file_get_contents(&quot;sign.php&quot;), TRUE);
  exit(0);
}

$keys = get_keys();
$privkey = $keys[0];
$pubkey = $keys[1];

if ($privkey === FALSE || $pubkey === FALSE) {
  die(&quot;Could not load keys. Contact admin.&lt;br/&gt;&quot;);
}

$file_info = $_FILES['userfile'];
check_uploaded_file($file_info);

$text = pdf_to_text($file_info['tmp_name']);
print &quot;Extracted text: \&quot;$text\&quot;&lt;br/&gt;&quot;;

$execute_query = &quot;EXECUTE &quot;;
$echo_query = &quot;ECHO &quot;;
if (substr($text, 0, strlen($execute_query)) === $execute_query) {
  print &quot;I don't sign EXECUTE commands. Go away.&lt;br/&gt;&quot;;
} else if (substr($text, 0, strlen($echo_query)) === $echo_query) {
  print &quot;I'm OK with ECHO commands. Here is the signature: &lt;br/&gt;&quot;;
  $data = file_get_contents($file_info['tmp_name']);
  openssl_sign($data, $signature, $privkey);
  print bin2hex($signature);
} else {
  print &quot;I can't recognize the command type. Go away.&lt;br/&gt;&quot;;
}

?&gt;
</code></pre>
<h2 id="2-writeup">2. Writeup</h2>
<ul>
<li>
<p>shellme.php是入口，用户将首位为<code>ECHO</code>的pdf上传，得到<code>signature</code></p>
</li>
<li>
<p>将<code>signature</code>和pdf上传给<code>execute.php</code></p>
<ul>
<li>首先检查<code>signature</code>一致性</li>
<li>如果pdf首位为<code>ECHO</code>则显示PDF内容</li>
<li>如果pdf首位为<code>EXECUTE</code>则执行PDF内容</li>
</ul>
</li>
</ul>
<p>这道题的考点在<code>检查signature一致性</code>这里，<br>
注意题目中验证签名用的函数是<code>openssl_verify</code><br>
该函数默认使用<code>sha1</code>算法进行签名<br>
由于<code>sha1</code><a href="https://security.googleblog.com/2017/02/announcing-first-sha1-collision.html">不安全</a>，我们可以使用<a href="https://github.com/nneonneo/sha1collider">工具</a>碰撞出首位为<code>EXECUTE</code>而非<code>ECHO</code>,但<code>signature</code>一致的pdf内容,从而RCE。</p>
<h2 id="3-info">3. Info</h2>
<p>challenge source code <a href="https://gist.github.com/janmasarik/232381eec3918313b5b4d2c20ca1ed0f">https://gist.github.com/janmasarik/232381eec3918313b5b4d2c20ca1ed0f</a></p>
<p>CTF Time writeup <a href="https://ctftime.org/task/6094">https://ctftime.org/task/6094</a></p>
<p>Writeup provider teams:</p>
<ul>
<li>mhackeroni</li>
<li>EmpireCTF</li>
<li>tuna$laves</li>
</ul>
<p>Author：Not Found, But Maybe</p>
<ul>
<li><a href="https://gist.github.com/janmasarik/">https://gist.github.com/janmasarik/</a> 就这哥们儿有题目源码</li>
<li><a href="https://github.com/nneonneo">https://github.com/nneonneo/</a> 这位哥在题目之前写了对应的工具</li>
<li>Marc Stevens(CWI Amsterdam) 这位是《Announcing the first SHA1 collision》一作</li>
<li>Elie Bursztein (Google) 《Announcing the first SHA1 collision》二作</li>
</ul>
<p>writeup for study: <a href="https://github.com/0e85dc6eaf/CTF-Writeups/tree/05ad6a9ecbc19ceb8890f4581dfee36f16d164aa/DEF%20CON%20CTF%20Qualifier%202018/Easy%20Pisy#easy-pisy">https://github.com/0e85dc6eaf/CTF-Writeups/tree/05ad6a9ecbc19ceb8890f4581dfee36f16d164aa/DEF%20CON%20CTF%20Qualifier%202018/Easy%20Pisy#easy-pisy</a></p>
<p>tools used:</p>
<ul>
<li><a href="https://github.com/nneonneo/sha1collider">https://github.com/nneonneo/sha1collider</a></li>
<li><a href="https://github.com/cr-marcstevens/sha1collisiondetection">https://github.com/cr-marcstevens/sha1collisiondetection</a></li>
</ul>
<h2 id="4-analysis-of-author">4. Analysis of Author</h2>
<p>由于还不能确定这道题的出题人是谁，就先面向目前可能性比较大的前四位分析。</p>
<h3 id="41-janmasarik">4.1 janmasarik</h3>
<ul>
<li>languages
<ul>
<li>python\go\php</li>
</ul>
</li>
<li>社交媒体
<ul>
<li>https://twitter.com/s14ve</li>
<li>https://masarik.sh/</li>
</ul>
</li>
<li>Recent
<ul>
<li><a href="https://github.com/janmasarik/resolvers">resolvers</a> DNS拦截的检查工具？20210416</li>
<li><a href="https://github.com/janmasarik/low-hanging">low-hanging</a> 漏洞扫描器</li>
<li><a href="https://github.com/janmasarik/bucketsperm">bucketsperm</a> 用上面的low-hanging做的 云存储桶 权限 漏洞扫描器？</li>
<li><a href="https://is.muni.cz/th/de05t/master_thesis_final.pdf">Automating Bug Bounty</a> 论文:自动挖漏洞？这个好像专门挖云存储漏洞，应该和bucketsperm有联动</li>
</ul>
</li>
</ul>
<p>jan.masarik先生19年至今的动态主要在云存储漏洞的自动挖掘上。</p>
<h3 id="42-nneonneo-robert-xiao">4.2 nneonneo (Robert Xiao)</h3>
<ul>
<li>languages
<ul>
<li>python</li>
</ul>
</li>
<li>社交媒体
<ul>
<li>https://twitter.com/nneonneo</li>
<li>https://www.robertxiao.ca</li>
</ul>
</li>
<li>Recent
<ul>
<li><a href="https://github.com/nneonneo/ghidra">Ghidra 逆向工具</a></li>
<li><a href="https://github.com/nneonneo/iOS-Torrent-Client">iOS-Torrent-Client</a></li>
<li><a href="https://github.com/nneonneo/iOS-SOCKS-Server">ios-sock</a></li>
<li><a href="https://github.com/nneonneo/ntfsrecover">ntfsrecover</a></li>
</ul>
</li>
</ul>
<p>nneonneo 大佬2020年底的github动态都是在搞RE和PWN，做的研究工作都比较偏底层。应该不会出web的题目⑧<br>
而且nneonneo大佬似乎是CTFer而非出题人，但他是怎么在出题之前设计出做题工具的呢<br>
说明他看了Marc的文章..</p>
<h3 id="43-marc-stevens">4.3 Marc Stevens</h3>
<ul>
<li>
<p>languages</p>
<ul>
<li>C/C++</li>
</ul>
</li>
<li>
<p>社交媒体</p>
<ul>
<li><a href="https://github.com/cr-marcstevens">Github</a></li>
<li><a href="https://scholar.google.nl/citations?user=ObZrtPYAAAAJ&amp;hl=nl">google学术</a></li>
<li><a href="https://marc-stevens.nl/research/">个人博客</a></li>
</ul>
</li>
<li>
<p>Recent</p>
<ul>
<li><a href="https://eprint.iacr.org/2019/197.pdf">Non-interactive cryptographic timestamping based on verifiable delay functions 2020</a></li>
<li><a href="https://ir.cwi.nl/pub/29339/29339.pdf">Real World Cryptanalysis 2019</a></li>
<li><a href="https://www.h2020prometheus.eu/sites/default/files/2019-11/The%20General%20Sieve%20Kernel%20and%20New%20Records%20in%20Lattice%20Reduction.pdf">The general sieve kernel and new records in lattice reduction</a></li>
<li><a href="https://github.com/cr-marcstevens/sha1collisiondetection">sha1collisiondetection</a> 但这个似乎还是18年defcon的EasyPisy考点</li>
<li><a href="https://github.com/cr-marcstevens/snippets">snippets</a> Marc个人的脚本收集仓库</li>
</ul>
</li>
<li>
<p>学习一下<code>Non-interactive cryptographic timestamping based on verifiable delay functions</code></p>
</li>
<li>
<p>仔细看一下<code>sha1collisiondetection</code>的更新细节，也许更新了新的知识点可以出题？</p>
</li>
<li>
<p>这位老师还写了一篇区块链的文章 <a href="https://dl.eusset.eu/bitstream/20.500.12015/3160/1/blockchain2018_04.pdf">On immutability of blockchains</a></p>
</li>
</ul>
<h3 id="44-elie-bursztein-google">4.4 Elie Bursztein (Google)</h3>
<ul>
<li>languages
<ul>
<li>Python/PHP</li>
</ul>
</li>
<li>社交媒体
<ul>
<li><a href="https://elie.net">个人博客</a></li>
<li><a href="https://github.com/ebursztein?tab=repositories">Github</a></li>
<li><a href="https://scholar.google.com/citations?hl=zh-CN&amp;user=Ayw4GsAAAAAJ&amp;view_op=list_works&amp;sortby=pubdate">Google Scholar</a></li>
</ul>
</li>
<li>Recent
<ul>
<li><a href="https://research.google/pubs/pub49786.pdf">Sok: Hate, harassment, and the changing landscape of online abuse 2021</a></li>
<li><a href="https://research.google/pubs/pub49626.pdf">Spotlight: Malware Lead Generation at Scale</a></li>
<li><a href="https://research.google/pubs/pub49775.pdf">Who is targeted by email-based phishing and malware? Measuring factors that differentiate risk</a></li>
<li><a href="https://arxiv.org/pdf/2006.10861">Coinpolice: Detecting hidden cryptojacking attacks with neural networks</a></li>
</ul>
</li>
</ul>
<p>尽管是《Announcing the first SHA1 collision》二作，Elie的主要精力还是投入在了Phishing、Malware、Abuse等领域。</p>
<blockquote>
<p>我比较喜欢他博客里这些没有数学公式的科普文章，像看小说一样欢乐。我女朋友则喜欢有逻辑推导、数学演算的东西，会更优美、更艺术一些...</p>
</blockquote>
<p>从领域相匹配度的角度分析,Elie也比较符合EasyPisy出题人的画像。<br>
不过博客里几乎没看到有关CTF的内容。</p>
<ul>
<li><a href="https://elie.net/talk/a-hacker-guide-to-side-channel-attack-surface-reduction-using-deep-learning/">A Hacker’s guide to reducing side-channel attack surfaces using deep-learning</a></li>
</ul>
<p>这个&quot;基于深度学习来防御旁路攻击&quot;的思路宣讲于<code>Defcon 28</code>&amp;<code>Black Hat USA 2020</code> // TODO<br>
密码学旁路攻击: <a href="http://www.arocmag.com/getarticle?aid=93341d415ab5a106">基于旁路攻击的AES算法中间变量脆弱点</a> // TODO</p>
<h2 id="5-语言中的签名函数">5. 语言中的签名函数</h2>
<p>先找一下各语言标准库中的签名函数，再进一步找第三方库中引入的签名函数。</p>
<h3 id="51-php">5.1 php</h3>
<p>https://www.php.net/manual/zh/function.hash-hmac-file.php<br>
https://segmentfault.com/a/1190000020201103<br>
https://www.php.net/manual/zh/ref.openssl.php</p>
<h4 id="511-standards-library">5.1.1 <a href="https://www.php.net/manual/zh/refs.crypto.php">standards library</a></h4>
<h5 id="5111-hash">5.1.1.1 <a href="https://www.php.net/manual/zh/book.hash.php">Hash</a></h5>
<p>PHP 5.1.2开始，Hash成为内置拓展。<br>
PHP 7.4.0开始，Hash成为核心拓展，可以直接使用其函数。<br>
Hash 函数</p>
<ul>
<li>hash_algos — 返回已注册的哈希算法列表</li>
<li>hash_copy — 拷贝哈希运算上下文</li>
<li>hash_equals — 可防止时序攻击的字符串比较</li>
<li>hash_file — 给指定文件的内容生成哈希值</li>
<li>hash_final — 结束增量哈希，并且返回摘要结果</li>
<li>hash_hkdf — Generate a HKDF key derivation of a supplied key input</li>
<li>hash_hmac_algos — Return a list of registered hashing algorithms suitable for hash_hmac</li>
<li>hash_hmac_file — 使用 HMAC 方法和给定文件的内容生成带密钥的哈希值</li>
<li>hash_hmac — 使用 HMAC 方法生成带有密钥的哈希值</li>
<li>hash_init — 初始化增量哈希运算上下文</li>
<li>hash_pbkdf2 — 生成所提供密码的 PBKDF2 密钥导出</li>
<li>hash_update_file — 从文件向活跃的哈希运算上下文中填充数据</li>
<li>hash_update_stream — 从打开的流向活跃的哈希运算上下文中填充数据</li>
<li>hash_update — 向活跃的哈希运算上下文中填充数据</li>
<li>hash — 生成哈希值 （消息摘要）</li>
</ul>
<blockquote>
<p>Hash系列函数的<code>algo</code>参数没有默认值。</p>
</blockquote>
<h5 id="5112-密码散列算法函数">5.1.1.2 <a href="https://www.php.net/manual/zh/ref.password.php">密码散列算法函数</a></h5>
<p>下列函数可以直接调用</p>
<blockquote>
<p>如果要使用 Argon2 密码哈希，PHP 必须用 --with-password-argon2[=DIR] 配置选项和 libargon2 构建。<br>
密码散列算法函数</p>
</blockquote>
<ul>
<li>password_algos — Get available password hashing algorithm IDs</li>
<li>password_get_info — 返回指定散列（hash）的相关信息</li>
<li>password_hash — 创建密码的散列（hash）</li>
<li>password_needs_rehash — 检测散列值是否匹配指定的选项</li>
<li>password_verify — 验证密码是否和散列值匹配<br>
<code>password_hash</code>所有可用的签名算法<a href="https://www.php.net/manual/zh/password.constants.php">如下</a></li>
<li>PASSWORD_BCRYPT (default) <a href="https://en.wikipedia.org/wiki/Bcrypt">学习链接</a></li>
<li>PASSWORD_ARGON2I <a href="https://zhuanlan.zhihu.com/p/80490980">学习链接</a></li>
<li>PASSWORD_ARGON2ID</li>
<li>PASSWORD_ARGON2_DEFAULT_MEMORY_COST</li>
<li>PASSWORD_ARGON2_DEFAULT_TIME_COST</li>
<li>PASSWORD_ARGON2_DEFAULT_THREADS<br>
慢哈希函数<a href="https://tate-young.github.io/2019/05/21/bcrypt.html">学习链接</a> // 这啥啊，看不懂...等女朋友看完讲一下吧...<br>
ARGON2<a href="https://github.com/P-H-C/phc-winner-argon2/raw/master/argon2-specs.pdf">学习链接</a></li>
</ul>
<h4 id="512-第三方库">5.1.2 第三方库</h4>
<h5 id="5121-openssl">5.1.2.1 <a href="https://www.php.net/manual/zh/ref.openssl.php">OpenSSL</a></h5>
<p>要使用 PHP 的 OpenSSL 模块时，须使用 --with-openssl[=DIR] 参数来编译 PHP。<br>
OpenSSL库所有的函数如下</p>
<pre><code>openssl_cipher_iv_length — 获取密码iv长度
openssl_cms_decrypt — Decrypt a CMS message
openssl_cms_encrypt — Encrypt a CMS message
openssl_cms_read — Export the CMS file to an array of PEM certificates
openssl_cms_sign — Sign a file
openssl_cms_verify — Verify a CMS signature
openssl_csr_export_to_file — 将CSR导出到文件
openssl_csr_export — 将CSR作为字符串导出
openssl_csr_get_public_key — 返回CSR的公钥
openssl_csr_get_subject — 返回CSR的主题
openssl_csr_new — 生成一个 CSR
openssl_csr_sign — 用另一个证书签署 CSR (或者本身) 并且生成一个证书
openssl_decrypt — 解密数据
openssl_dh_compute_key — 计算远程DH密钥(公钥)和本地DH密钥的共享密钥
openssl_digest — 计算摘要
openssl_encrypt — 加密数据
openssl_error_string — 返回 openSSL 错误消息
openssl_free_key — 释放密钥资源
openssl_get_cert_locations — 检索可用的证书位置
openssl_get_cipher_methods — 获取可用的加密算法
openssl_get_curve_names — 获得ECC的可用曲线名称列表
openssl_get_md_methods — 获取可用的摘要算法
openssl_get_privatekey — 别名 openssl_pkey_get_private
openssl_get_publickey — 别名 openssl_pkey_get_public
openssl_open — 打开密封的数据
openssl_pbkdf2 — 生成一个 PKCS5 v2 PBKDF2 字符串
openssl_pkcs12_export_to_file — 输出一个 PKCS#12 兼容的证书存储文件
openssl_pkcs12_export — 将 PKCS#12 兼容证书存储文件导出到变量
openssl_pkcs12_read — 将 PKCS#12 证书存储区解析到数组中
openssl_pkcs7_decrypt — 解密一个 S/MIME 加密的消息
openssl_pkcs7_encrypt — 加密一个 S/MIME 消息
openssl_pkcs7_read — 将PKCS7文件导出为PEM格式证书的数组
openssl_pkcs7_sign — 对一个 S/MIME 消息进行签名
openssl_pkcs7_verify — 校验一个已签名的 S/MIME 消息的签名
openssl_pkey_derive — Computes shared secret for public value of remote and local DH or ECDH key
openssl_pkey_export_to_file — 将密钥导出到文件中
openssl_pkey_export — 将一个密钥的可输出表示转换为字符串
openssl_pkey_free — 释放一个私钥
openssl_pkey_get_details — 返回包含密钥详情的数组
openssl_pkey_get_private — 获取私钥
openssl_pkey_get_public — 从证书中解析公钥，以供使用。
openssl_pkey_new — 生成一个新的私钥
openssl_private_decrypt — 使用私钥解密数据
openssl_private_encrypt — 使用私钥加密数据
openssl_public_decrypt — 使用公钥解密数据
openssl_public_encrypt — 使用公钥加密数据
openssl_random_pseudo_bytes — 生成一个伪随机字节串
openssl_seal — 密封 (加密) 数据
openssl_sign — Generate signature
openssl_spki_export_challenge — 导出与签名公钥和挑战相关的挑战字符串
openssl_spki_export — 通过签名公钥和挑战导出一个可用的PEM格式的公钥
openssl_spki_new — 生成一个新的签名公钥和挑战
openssl_spki_verify — 验证签名公钥和挑战。
openssl_verify — 验证签名
openssl_x509_check_private_key — 检查私钥是否对应于证书
openssl_x509_checkpurpose — 验证是否可以为特定目的使用证书
openssl_x509_export_to_file — 导出证书至文件
openssl_x509_export — 以字符串格式导出证书
openssl_x509_fingerprint — 计算一个给定的x.509证书的指纹或摘要
openssl_x509_free — 释放证书资源
openssl_x509_parse — 解析一个X509证书并作为一个数组返回信息
openssl_x509_read — 解析一个x.509证书并返回一个资源标识符
openssl_x509_verify — Verifies digital signature of x509 certificate against a public key
</code></pre>
<p>以默认算法对openssl库函数进行分类,如下:<br>
默认加密算法: <code>OPENSSL_CIPHER_RC2_40</code>的函数</p>
<ul>
<li>openssl_cms_encrypt</li>
<li>openssl_pkcs7_encrypt</li>
</ul>
<p>默认编码方法:<code>OPENSSL_ENCODING_SMIME</code>的函数</p>
<ul>
<li>openssl_cms_verify</li>
<li>openssl_cms_sign</li>
</ul>
<p>默认加解密方法:<code>RC4</code>的函数</p>
<ul>
<li>openssl_open</li>
<li>openssl_seal</li>
</ul>
<p>默认签名算法: <code>SHA1</code>的函数</p>
<ul>
<li>openssl_pbkdf2</li>
<li>openssl_sign</li>
<li>openssl_verify</li>
<li>openssl_x509_fingerprint</li>
</ul>
<p>默认签名Flag: <code>PKCS7_DETACHED</code>的函数</p>
<ul>
<li>openssl_​pkcs7_​sign</li>
</ul>
<p>默认Padding:<code>OPENSSL_PKCS1_PADDING</code>的函数</p>
<ul>
<li>openssl_private_decrypt</li>
<li>openssl_private_encrypt</li>
<li>openssl_public_decrypt</li>
<li>openssl_public_encrypt</li>
</ul>
<h3 id="52-python">5.2 python</h3>
<h4 id="521-standards-library">5.2.1 standards library</h4>
<h5 id="5211-hashlib">5.2.1.1 <a href="https://docs.python.org/3.6/library/hashlib.html">hashlib</a></h5>
<p>hashlib底层代码为openssl开源库，openssl支持的方法，hashlib都能支持。<br>
所有支持的方法有:</p>
<pre><code>DSA, DSA-SHA, MD4, MD5, RIPEMD160, SHA, SHA1, SHA224, SHA256,
SHA384, SHA512, blake2b, blake2s, dsaEncryption, dsaWithSHA,
ecdsa-with-SHA1, md4, md5, ripemd160, sha, sha1, sha224, sha256,
sha384, sha3_224, sha3_256, sha3_384, sha3_512, sha512,
shake_128, shake_256, whirlpool
</code></pre>
<p>其中，无论执行运行环境是什么操作系统，都必然可用的方法有:</p>
<pre><code>blake2b, blake2s, md5, sha1, sha224, sha256, sha384, sha3_224, sha3_256, sha3_384, sha3_512, sha512, shake_128, shake_256
</code></pre>
<blockquote>
<p>不同环境的<code>algorithms_guaranteed</code>不同<br>
这里的环境为<code>Python3.7.7 MacOS 10.14.6</code></p>
</blockquote>
<p>hashlib使用方法如下:</p>
<pre><code class="language-python">import hashlib
h = hashlib.md5()
h.update(&quot;hello&quot;.encode('utf-8'))
print(h.hexdigest())

h = hashlib.sha1()
h.update(&quot;hello&quot;.encode('utf-8'))
print(h.hexdigest())
</code></pre>
<p>hashlib用方法名初始化,代码如下:</p>
<pre><code>hash_name = &quot;sha1&quot;
h = hashlib.new(hash_name)
h.update(args.data.encode('utf-8'))
print(h.hexdigest())
</code></pre>
<p>这种不明说用了什么hash的写法更方便出题。</p>
<h5 id="5212-hmac">5.2.1.2 hmac</h5>
<p>规范hmac的<a href="https://tools.ietf.org/html/rfc2104.html">RFC标准</a><br>
hmac是一个检查通信过程中消息完整性的标准化实现</p>
<p>使用方法如下</p>
<pre><code class="language-python">import hmac
import hashlib

h = hmac.new(b'secret-shared-key', 'hello', hashlib.sha1)
digest = h.hexdigest()
print(digest)
</code></pre>
<p>hmac.new函数的参数有三个：秘钥、消息、签名算法<br>
其中，签名算法默认为<code>md5</code></p>
<h4 id="522-第三方库">5.2.2 第三方库</h4>
<h5 id="5221-cryptography">5.2.2.1 cryptography</h5>
<p><a href="https://pypi.org/project/cryptography/">Cryptography</a>：一个提供了加密算法和原语的 python 包。</p>
<h5 id="5222-voidspace">5.2.2.2 VoidSpace</h5>
<p><a href="http://www.voidspace.org.uk/python/weblog/arch_d7_2006_10_07.shtml#e497">VoidSpace</a> 是 适用于IronPython的Hashlib装饰器</p>
<h3 id="53-go">5.3 go</h3>
<h4 id="531-standards-library">5.3.1 standards library</h4>
<h5 id="5311-crypto">5.3.1.1 crypto</h5>
<p>所有可用的Hash方法如下</p>
<pre><code class="language-go">const (
    MD4         Hash = 1 + iota // import golang.org/x/crypto/md4
    MD5                         // import crypto/md5
    SHA1                        // import crypto/sha1
    SHA224                      // import crypto/sha256
    SHA256                      // import crypto/sha256
    SHA384                      // import crypto/sha512
    SHA512                      // import crypto/sha512
    MD5SHA1                     // no implementation; MD5+SHA1 used for TLS RSA
    RIPEMD160                   // import golang.org/x/crypto/ripemd160
    SHA3_224                    // import golang.org/x/crypto/sha3
    SHA3_256                    // import golang.org/x/crypto/sha3
    SHA3_384                    // import golang.org/x/crypto/sha3
    SHA3_512                    // import golang.org/x/crypto/sha3
    SHA512_224                  // import crypto/sha512
    SHA512_256                  // import crypto/sha512
    BLAKE2s_256                 // import golang.org/x/crypto/blake2s
    BLAKE2b_256                 // import golang.org/x/crypto/blake2b
    BLAKE2b_384                 // import golang.org/x/crypto/blake2b
    BLAKE2b_512                 // import golang.org/x/crypto/blake2b
)
</code></pre>
<p>使用方法，以<code>MD5举例</code></p>
<pre><code class="language-go">func GetMd5String(s string) string {
    h := md5.New()
    h.Write([]byte(s))
    return hex.EncodeToString(h.Sum(nil))
}
</code></pre>
<h5 id="5312-crypto包下其他加密包">5.3.1.2 crypto包下其他加密包</h5>
<pre><code>aes,cipher,des,dsa,ecdsa,elliptic,hmac,md5,rand,rc4,rsa,sha1,sha256,sha512,subtle,tls,x509
</code></pre>
<h4 id="532-第三方库">5.3.2 第三方库</h4>
<p>Golang似乎没有特别主流的第三方加密库，标准库已经可以解决大部分需求。</p>
<h2 id="6-密码学知识点">6. 密码学知识点</h2>
<h3 id="md5">md5</h3>
<p><a href="https://en.wikipedia.org/wiki/MD5">https://en.wikipedia.org/wiki/MD5</a><br>
<a href="https://zhuanlan.zhihu.com/p/37257569">https://zhuanlan.zhihu.com/p/37257569</a></p>
<h3 id="慢哈希函数">慢哈希函数</h3>
<p><a href="https://tate-young.github.io/2019/05/21/bcrypt.html">https://tate-young.github.io/2019/05/21/bcrypt.html</a><br>
对了对抗用字典暴破的攻击者，设计出了这种慢哈希函数。<br>
除了所有哈希函数都具备的&quot;给hash，让反着算，算不出来原文&quot;的特性外，同时“有原文，正着算Hash,特别特别慢”<br>
比如<code>bcrypt</code>,<code>scrypt</code>,<code>PBKDF2</code>等<br>
python的bcrypt写法如下:</p>
<pre><code class="language-python">import bcrypt

passwd = b's$cret12'

salt = bcrypt.gensalt()
hashed = bcrypt.hashpw(passwd, salt)

print(salt)
print(hashed)
</code></pre>
<h3 id="argon2">ARGON2</h3>
<p><a href="https://github.com/P-H-C/phc-winner-argon2/raw/master/argon2-specs.pdf">https://github.com/P-H-C/phc-winner-argon2/raw/master/argon2-specs.pdf</a><br>
<a href="https://eprint.iacr.org/2016/759.pdf">Towards Practical Attacks on Argon2i and Balloon Hashing</a><br>
也是一种慢哈希函数。<br>
<code>Memory-hard hash function</code>：通过提高算法中内存的使用量，来提高算法的Hash的耗时。</p>
<h3 id="rc2_40">RC2_40</h3>
<p>http://cryptowiki.net/index.php?title=RC2/40_english<br>
https://github.com/SaschaWessel/rc2-40-cbc</p>
<h3 id="smime">SMIME</h3>
<p><a href="https://www.cse.scu.edu/~tschwarz/coen350_03/Lectures/smime.html">https://www.cse.scu.edu/~tschwarz/coen350_03/Lectures/smime.html</a><br>
<a href="https://zh.wikipedia.org/zh-hans/S/MIME">https://zh.wikipedia.org/zh-hans/S/MIME</a><br>
安全的电子邮件加密方式<br>
<a href="https://4hou.win/wordpress/?p=15890">如何使用SMIME</a></p>
<h3 id="s盒">S盒</h3>
<p><a href="https://zh.wikipedia.org/wiki/S%E7%9B%92">https://zh.wikipedia.org/wiki/S%E7%9B%92</a><br>
通常，S-Box接受特定数量的输入比特m，并将其转换为特定数量的输出比特n，其中n 不一定等于m[1]。一个m×n的S盒可以通过包含2m条目，每条目n比特的查找表实现。<br>
S盒通常是固定的（例如DES和AES加密算法）, 也有一些加密算法的S盒是基于密钥动态生成的（例如Blowfish和双鱼算法加密算法）。</p>
<h3 id="rc4">RC4</h3>
<p>https://zh.wikipedia.org/zh-hans/RC4</p>
<h3 id="sha1">SHA1</h3>
<p>https://zh.wikipedia.org/wiki/SHA-1</p>
<h3 id="pkcs7_detached">PKCS7_DETACHED</h3>
<p>https://segmentfault.com/a/1190000019793040</p>
<h3 id="openssl_pkcs1_padding">OPENSSL_PKCS1_PADDING</h3>
<p>https://blog.csdn.net/liuxianbing119/article/details/7405628</p>
<h3 id="ecdsa">ecdsa</h3>
<p>https://zhuanlan.zhihu.com/p/97953640</p>
<h3 id="subtle">subtle</h3>
<blockquote>
<p>subtle不仅是golang加密包的名字，还是一个男士挎包品牌。<br>
看上去是那种明明很奢华，但在我身上就被穿成地摊货的款式...<br>
诶，又走神了<br>
<img src="https://img-blog.csdnimg.cn/20210426135026387.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NlbWFvNDU0OA==,size_16,color_FFFFFF,t_70" alt="" loading="lazy"></p>
</blockquote>
<p>https://documentation.help/Golang/crypto_subtle.htm</p>
<h2 id="7-bucket-配置错误">7. Bucket 配置错误</h2>
<p>jan.masarik先生19年至今的动态主要在云存储漏洞的自动挖掘上。<br>
- <a href="https://github.com/janmasarik/bucketsperm">bucketsperm</a><br>
- <a href="https://is.muni.cz/th/de05t/master_thesis_final.pdf">Automating Bug Bounty</a></p>
<p>先来学习一下Bucket错误配置漏洞是咋回事。<br>
<a href="https://www.cyclonis.com/zh-hans/thousands-of-patients-data-been-breached-misconfigured-amazon-s3-buckets/">由于配置错误的Amazon S3存储桶导致成千上万的患者数据遭到破坏</a><br>
使用OSS时须先创建Bucket存储空间。<br>
<a href="https://help.aliyun.com/document_detail/31885.html">阿里云如何创建Bucket</a><br>
在jan.masarik先生的论文中，总结了用户在创建buckets时经常犯的错误：</p>
<ul>
<li><strong>不配置权限限制ACL，所有内容public</strong><a href="https://help.aliyun.com/document_detail/66168.html">导致敏感信息泄露</a></li>
<li>同时很多人会像命名变量那样，<strong>以bucket的用途来命名bucket</strong>。<br>
使得很多存储敏感信息的Bucket可以通过暴破子域名的方式被访问到。<br>
jan.masarik先生将这些可能存储敏感信息的bucket name汇总成了 下表中的Group2<br>
同时给出了，经常被使用 但一般不存储敏感信息的Bucket name Group 1<br>
<img src="https://img-blog.csdnimg.cn/20210426135054483.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NlbWFvNDU0OA==,size_16,color_FFFFFF,t_70" alt="" loading="lazy"><br>
在论文的最后，jan.masarik建议这些OSS 提供商设置bucket name黑名单。<br>
查阅文档，阿里云的OSS就没有这个限制。<br>
<img src="https://img-blog.csdnimg.cn/20210426135116978.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NlbWFvNDU0OA==,size_16,color_FFFFFF,t_70" alt="" loading="lazy"><br>
我在google和github上面随便找了几个oss的教程，<br>
访问了一下教程中的oss链接。</li>
<li>当bucket存在，path存在，但ACL private时，报如下错误。<br>
<img src="https://img-blog.csdnimg.cn/20210426135200857.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NlbWFvNDU0OA==,size_16,color_FFFFFF,t_70" alt="" loading="lazy"></li>
<li>当bucket存在，但是path不存在时，报如下错误<br>
<img src="https://img-blog.csdnimg.cn/20210426135224307.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NlbWFvNDU0OA==,size_16,color_FFFFFF,t_70" alt="" loading="lazy"></li>
<li>当bucket不存在时，报如下错误<br>
<img src="https://img-blog.csdnimg.cn/20210426135312511.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NlbWFvNDU0OA==,size_16,color_FFFFFF,t_70" alt="" loading="lazy"></li>
<li>当bucket存在，path存在，同时还有访问权限时，就可以访问对应的文件或文件夹。<br>
<img src="https://img-blog.csdnimg.cn/20210426135330408.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NlbWFvNDU0OA==,size_16,color_FFFFFF,t_70" alt="" loading="lazy"><br>
暂时还没有找到ACL错误配置的oss bucket<br>
通过子域名解析的方式搜集了一些oss的链接，确实有Group2中的关键字。看上去的确诱人。<br>
<img src="https://img-blog.csdnimg.cn/20210426135351135.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NlbWFvNDU0OA==,size_16,color_FFFFFF,t_70" alt="" loading="lazy"><br>
然而访问结果欠佳，应该是bucket对应的子域名注销了oss服务。<br>
<img src="https://img-blog.csdnimg.cn/20210426135405976.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NlbWFvNDU0OA==,size_16,color_FFFFFF,t_70" alt="" loading="lazy"><br>
暂时没有遇到jan先生论文里说的oss配置错误漏洞实例。</li>
</ul>
<h2 id="8-non-interactive-cryptographic-timestamping-based-on-verifiable-delay-functions">8. <a href="https://eprint.iacr.org/2019/197.pdf">《Non-interactive cryptographic timestamping based on verifiable delay functions》</a></h2>
<p>我们平常在web应用中的时间戳校验，都是依赖于某个权威服务器。<br>
为了实现去中心化，Marc Stevens提出了这种基于VDF的去中心化时间戳方案。</p>
<h2 id="9-sha1collisiondetection">9. <a href="https://github.com/cr-marcstevens/sha1collisiondetection">sha1collisiondetection</a></h2>
<p>TODO</p>
<h2 id="10-on-immutability-of-blockchains">10. <a href="https://dl.eusset.eu/bitstream/20.500.12015/3160/1/blockchain2018_04.pdf">《On immutability of blockchains》</a></h2>
<p>TODO</p>
<h2 id="11-collect-crypto-2021-paper">11. collect Crypto 2021 Paper</h2>
<p>TODO</p>
<h2 id="12-a-hackers-guide-to-reducing-side-channel-attack-surfaces-using-deep-learning">12. <a href="https://elie.net/talk/a-hacker-guide-to-side-channel-attack-surface-reduction-using-deep-learning/">A Hacker’s guide to reducing side-channel attack surfaces using deep-learning</a></h2>
<p>这个&quot;基于深度学习来防御旁路攻击&quot;的思路宣讲于<code>Defcon 28</code>&amp;<code>Black Hat USA 2020</code> // TODO</p>
<h2 id="13-基于旁路攻击的aes算法中间变量脆弱点">13. 基于旁路攻击的AES算法中间变量脆弱点</h2>
<p>密码学旁路攻击: <a href="http://www.arocmag.com/getarticle?aid=93341d415ab5a106">基于旁路攻击的AES算法中间变量脆弱点</a> // TODO</p>
<h1 id="总结">总结</h1>
<p>EasyPisy可能的出题人有四位，每个人可能的出题方向如下</p>
<ul>
<li>janmasarik: <strong>buckets未授权访问漏洞</strong>(WEB)</li>
<li>nneonneo (Robert Xiao): <strong>ios逆向</strong>(RE)</li>
<li>Marc Stevens: <strong>基于VDF的去中心化时间戳</strong>(BLOCKCHAIN)</li>
<li>Elie Bursztein (Google): <strong>AES旁路攻击</strong>(CRYPTO)</li>
</ul>
</div>
                              <div class="mdui-divider mdui-m-t-3"></div>
                              <div class="mdui-row-xs-2 mdui-m-t-2">
  <div class="mdui-col"> <div class="mdui-text-left"><a href="https://pandatea.life/post/defcon-2019-qualify-redacted-puzzle-writeup/">Defcon 2019 Qualify: redacted puzzle Writeup</a></div></div>
 <div class="mdui-col"><div class="mdui-text-right "><a href="https://pandatea.life/post/real-wolrd-ctf-3rd-writeup-or-easy-defi/">Real Wolrd CTF 3rd Writeup | Easy Defi</a></div> </div>
                                </div>
                                <div class="mdui-divider mdui-m-t-2"></div>
   
 <script src="https://pandatea.life/media/scripts/Valine.min.js"></script>
 <div class="comment"></div>

<script>
      new Valine({
            el: '.comment',

            app_id: 'IEi2zCTY1XD4rD7nJ4awDcpn-gzGzoHsz',


            app_key: 'LK0B9F5PMRXfeesBEQb4G1sw',


            placeholder: '上班累了...躺会儿吧',
            
            path: window.location.pathname,
            pageSize: 30,
            avatar:'mm', 
       })

    </script> 
<script>
    if(window.location.hash){
        var checkExist = setInterval(function() {
           if ($(window.location.hash).length) {
              $('html, body').animate({scrollTop: $(window.location.hash).offset().top-90}, 1000);
              clearInterval(checkExist);
           }
        }, 100);
    }
</script>
                         </article>
                 <div class="toc-container mdui-float-right">
                <ul class="markdownIt-TOC">
<li><a href="#defcon-2018-qualify-easy-pisy">Defcon 2018 Qualify: Easy Pisy</a>
<ul>
<li><a href="#1-source-code">1. Source Code</a></li>
<li><a href="#2-writeup">2. Writeup</a></li>
<li><a href="#3-info">3. Info</a></li>
<li><a href="#4-analysis-of-author">4. Analysis of Author</a>
<ul>
<li><a href="#41-janmasarik">4.1 janmasarik</a></li>
<li><a href="#42-nneonneo-robert-xiao">4.2 nneonneo (Robert Xiao)</a></li>
<li><a href="#43-marc-stevens">4.3 Marc Stevens</a></li>
<li><a href="#44-elie-bursztein-google">4.4 Elie Bursztein (Google)</a></li>
</ul>
</li>
<li><a href="#5-%E8%AF%AD%E8%A8%80%E4%B8%AD%E7%9A%84%E7%AD%BE%E5%90%8D%E5%87%BD%E6%95%B0">5. 语言中的签名函数</a>
<ul>
<li><a href="#51-php">5.1 php</a>
<ul>
<li><a href="#511-standards-library">5.1.1 standards library</a>
<ul>
<li><a href="#5111-hash">5.1.1.1 Hash</a></li>
<li><a href="#5112-%E5%AF%86%E7%A0%81%E6%95%A3%E5%88%97%E7%AE%97%E6%B3%95%E5%87%BD%E6%95%B0">5.1.1.2 密码散列算法函数</a></li>
</ul>
</li>
<li><a href="#512-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93">5.1.2 第三方库</a>
<ul>
<li><a href="#5121-openssl">5.1.2.1 OpenSSL</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#52-python">5.2 python</a>
<ul>
<li><a href="#521-standards-library">5.2.1 standards library</a>
<ul>
<li><a href="#5211-hashlib">5.2.1.1 hashlib</a></li>
<li><a href="#5212-hmac">5.2.1.2 hmac</a></li>
</ul>
</li>
<li><a href="#522-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93">5.2.2 第三方库</a>
<ul>
<li><a href="#5221-cryptography">5.2.2.1 cryptography</a></li>
<li><a href="#5222-voidspace">5.2.2.2 VoidSpace</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#53-go">5.3 go</a>
<ul>
<li><a href="#531-standards-library">5.3.1 standards library</a>
<ul>
<li><a href="#5311-crypto">5.3.1.1 crypto</a></li>
<li><a href="#5312-crypto%E5%8C%85%E4%B8%8B%E5%85%B6%E4%BB%96%E5%8A%A0%E5%AF%86%E5%8C%85">5.3.1.2 crypto包下其他加密包</a></li>
</ul>
</li>
<li><a href="#532-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93">5.3.2 第三方库</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#6-%E5%AF%86%E7%A0%81%E5%AD%A6%E7%9F%A5%E8%AF%86%E7%82%B9">6. 密码学知识点</a>
<ul>
<li><a href="#md5">md5</a></li>
<li><a href="#%E6%85%A2%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0">慢哈希函数</a></li>
<li><a href="#argon2">ARGON2</a></li>
<li><a href="#rc2_40">RC2_40</a></li>
<li><a href="#smime">SMIME</a></li>
<li><a href="#s%E7%9B%92">S盒</a></li>
<li><a href="#rc4">RC4</a></li>
<li><a href="#sha1">SHA1</a></li>
<li><a href="#pkcs7_detached">PKCS7_DETACHED</a></li>
<li><a href="#openssl_pkcs1_padding">OPENSSL_PKCS1_PADDING</a></li>
<li><a href="#ecdsa">ecdsa</a></li>
<li><a href="#subtle">subtle</a></li>
</ul>
</li>
<li><a href="#7-bucket-%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF">7. Bucket 配置错误</a></li>
<li><a href="#8-non-interactive-cryptographic-timestamping-based-on-verifiable-delay-functions">8. 《Non-interactive cryptographic timestamping based on verifiable delay functions》</a></li>
<li><a href="#9-sha1collisiondetection">9. sha1collisiondetection</a></li>
<li><a href="#10-on-immutability-of-blockchains">10. 《On immutability of blockchains》</a></li>
<li><a href="#11-collect-crypto-2021-paper">11. collect Crypto 2021 Paper</a></li>
<li><a href="#12-a-hackers-guide-to-reducing-side-channel-attack-surfaces-using-deep-learning">12. A Hacker’s guide to reducing side-channel attack surfaces using deep-learning</a></li>
<li><a href="#13-%E5%9F%BA%E4%BA%8E%E6%97%81%E8%B7%AF%E6%94%BB%E5%87%BB%E7%9A%84aes%E7%AE%97%E6%B3%95%E4%B8%AD%E9%97%B4%E5%8F%98%E9%87%8F%E8%84%86%E5%BC%B1%E7%82%B9">13. 基于旁路攻击的AES算法中间变量脆弱点</a></li>
</ul>
</li>
<li><a href="#%E6%80%BB%E7%BB%93">总结</a></li>
</ul>

              </div>

                        </div>
                 </div>
          
        </div>
        <script data-no-instant>
    (function ($) {
        $.extend({
            adamsOverload: function () {
                $.viewImage({
                    'target'  : '.post-neirong img',
                    'exclude' : '.vsmile-icons img , .song-links-item img',
                    'delay'   : 300
                });
            }
        });
    })(jQuery);
    jQuery.adamsOverload();
</script>
        <footer class="footer mdui-m-t-5 mdui-text-center">
               <nav class="social-links">
                      <ul>
                      
                            
                           
                            	
                        <li class="social-link"><a href="https://twitter.com/dawenc2020" target="_blank"><i class="iconfont icon-twitter"></i></a></li>
                         
                           
                            	
                        <li class="social-link"><a href="https://github.com/PandaTea" target="_blank"><i class="iconfont icon-github"></i></a></li>
                         
                           
                            	
                        <li class="social-link"><a href="https://www.zhihu.com/people/lee-congfei" target="_blank"><i class="iconfont icon-zhihu"></i></a></li>
                         
                           
                            
                           
                            
                           
                            	
                        <li class="social-link"><a href="NvRVDGzkRJJn" target="_blank"><i class="iconfont icon-telegram"></i></a></li>
                         
                           
                            
                           
                            
                           
                            	
                        <li class="social-link"><a href="836475291" target="_blank"><i class="iconfont icon-qq"></i></a></li>
                         
                           
                            	
                        <li class="social-link"><a href="https://weibo.com/u/2290808041" target="_blank"><i class="iconfont icon-weibo"></i></a></li>
                         
                           
                            
                           
                      </ul>
                    </nav>
                  <div class="copyright">
                      <p>该用户隐藏了power信息，并给你一个大抱抱。</p>
                  </div>
              </footer>
    </body>
</html>